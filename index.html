<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Auraassist - Aplikasi analisis kesehatan keuangan pribadi untuk mahasiswa dan pekerja">
    <meta name="theme-color" content="#0d47a1">
    <title>Auraassist - Analisis Kesehatan Keuangan</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cpath fill='%230d47a1' d='M100 10 L180 50 L180 150 L100 190 L20 150 L20 50 Z'/%3E%3Ctext x='100' y='120' font-family='Arial' font-size='80' font-weight='bold' fill='white' text-anchor='middle'%3EAA%3C/text%3E%3C/svg%3E">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --obsidian-black: #030305;
            --electric-blue: #3B82F6;
            --cyber-purple: #8B5CF6;
            --sidebar-blue: #0d47a1;
            --content-bg: #f4f6f9;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Space Grotesk', sans-serif;
        }

        .hidden {
            display: none !important;
        }

        /* ========== LANDING PAGE ========== */
        .landing-page {
            background: var(--obsidian-black);
            color: white;
            min-height: 100vh;
        }

        .hero-section {
            position: relative;
            min-height: 100vh;
            display: flex;
            align-items: center;
            overflow: hidden;
        }

        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: radial-gradient(circle, var(--electric-blue) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 20s infinite;
            opacity: 0.3;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-30px) translateX(20px); }
            50% { transform: translateY(-60px) translateX(-20px); }
            75% { transform: translateY(-30px) translateX(30px); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-headline {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.5rem;
        }

        .hero-subheadline {
            font-size: 1.3rem;
            color: #9ca3af;
            margin-bottom: 2rem;
        }

        .cta-button {
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.5);
            color: white;
        }

        .mockup-container {
            position: relative;
        }

        .mockup-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, var(--electric-blue) 0%, transparent 70%);
            filter: blur(60px);
            opacity: 0.4;
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.6; }
        }

        .mockup-image {
            position: relative;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .features-section {
            padding: 5rem 0;
            background: linear-gradient(180deg, var(--obsidian-black) 0%, #0a0c0f 100%);
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 20px;
            padding: 2.5rem;
            transition: all 0.3s;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            border-color: var(--electric-blue);
            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.2);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 1.5rem;
        }

        .aura-score-section {
            padding: 5rem 0;
            background: var(--obsidian-black);
        }

        .score-visual {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
        }

        .score-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(var(--electric-blue) 0deg 252deg, rgba(255,255,255,0.1) 252deg 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .score-inner {
            width: 220px;
            height: 220px;
            background: var(--obsidian-black);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .score-number {
            font-size: 4rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .footer-landing {
            background: var(--obsidian-black);
            padding: 3rem 0 1.5rem;
            border-top: 1px solid rgba(59, 130, 246, 0.2);
        }

        /* ========== AUTH PAGES ========== */
        .auth-page {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--obsidian-black) 0%, #0a0c0f 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .auth-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 20px;
            padding: 3rem;
            max-width: 450px;
            width: 100%;
            backdrop-filter: blur(10px);
        }

        .auth-title {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: white;
            padding: 0.8rem;
        }

        .form-control:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--electric-blue);
            color: white;
            box-shadow: 0 0 0 0.25rem rgba(59, 130, 246, 0.25);
        }

        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        /* Input di dashboard (background putih) */
        .card-stat .form-control {
            background: white;
            border: 1px solid #dee2e6;
            color: #212529;
        }

        .card-stat .form-control:focus {
            background: white;
            border-color: var(--electric-blue);
            color: #212529;
            box-shadow: 0 0 0 0.25rem rgba(59, 130, 246, 0.25);
        }

        .card-stat .form-control::placeholder {
            color: #6c757d;
        }

        .card-stat .form-label {
            color: #495057;
        }

        .form-label {
            color: #9ca3af;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .form-check-input {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .form-check-input:checked {
            background-color: var(--electric-blue);
            border-color: var(--electric-blue);
        }

        .form-check-label {
            color: #9ca3af;
        }

        /* ========== DASHBOARD ========== */
        .dashboard-wrapper {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 260px;
            background: var(--sidebar-blue);
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease-in-out;
            z-index: 1050;
            left: 0;
            top: 0;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1040;
            }

            .sidebar-overlay.active {
                display: block;
            }
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-brand {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, white, var(--electric-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: white;
        }

        .main-content {
            margin-left: 260px;
            flex: 1;
            background: var(--content-bg);
            padding: 2rem;
            width: calc(100% - 260px);
        }

        .topbar {
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-stat {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }

        .card-stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 25px rgba(0,0,0,0.12);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .aura-score-dashboard {
            text-align: center;
            padding: 2rem;
        }

        .score-display {
            font-size: 4rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-badge {
            display: inline-block;
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            margin-top: 1rem;
        }

        .status-sehat {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .status-kurang {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .status-kritis {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .btn-gradient {
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            border: none;
            color: white;
            font-weight: 600;
        }

        .btn-gradient:hover {
            opacity: 0.9;
            color: white;
        }

        .transaction-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 0.5rem;
            border-left: 4px solid var(--electric-blue);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .indicator-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid #10b981;
        }

        .indicator-card.warning {
            border-left-color: #f59e0b;
        }

        .indicator-card.danger {
            border-left-color: #ef4444;
        }

        .recommendation-box {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid var(--electric-blue);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        /* Monthly Cards */
        .month-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            transition: all 0.3s;
            border-left: 5px solid var(--electric-blue);
            margin-bottom: 1rem;
        }

        .month-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 25px rgba(0,0,0,0.12);
        }

        .month-card.sehat {
            border-left-color: #10b981;
        }

        .month-card.kurang {
            border-left-color: #f59e0b;
        }

        .month-card.kritis {
            border-left-color: #ef4444;
        }

        .month-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .month-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }

        .month-score {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--electric-blue), var(--cyber-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .month-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .month-stat-item {
            text-align: center;
        }

        .month-stat-label {
            font-size: 0.75rem;
            color: #6b7280;
            text-transform: uppercase;
            margin-bottom: 0.25rem;
        }

        .month-stat-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                margin-left: -260px;
            }

            .sidebar.active {
                margin-left: 0;
                box-shadow: 2px 0 10px rgba(0,0,0,0.3);
            }

            .main-content {
                margin-left: 0;
                width: 100%;
                padding: 1rem;
            }

            .hero-headline {
                font-size: 2rem;
            }

            .hero-subheadline {
                font-size: 1rem;
            }

            .mockup-container {
                margin-top: 2rem;
            }

            .month-stats {
                grid-template-columns: 1fr;
            }

            .score-display {
                font-size: 2.5rem !important;
            }

            .topbar {
                padding: 0.75rem 1rem;
            }

            .card-stat {
                padding: 1rem;
            }

            .feature-card {
                padding: 1.5rem;
            }

            .auth-card {
                padding: 2rem 1.5rem;
            }

            .cta-button {
                padding: 0.875rem 2rem;
                font-size: 1rem;
            }

            .hero-section {
                min-height: auto;
                padding: 3rem 0;
            }

            .features-section, .aura-score-section {
                padding: 3rem 0;
            }

            .score-visual {
                width: 200px;
                height: 200px;
            }

            .score-inner {
                width: 150px !important;
                height: 150px !important;
            }

            .month-card-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .month-card-header .text-end {
                margin-top: 1rem;
                text-align: left !important;
            }

            .table-responsive {
                font-size: 0.875rem;
            }

            .chart-container {
                height: 250px !important;
            }
        }

        @media (max-width: 576px) {
            .hero-headline {
                font-size: 1.75rem;
            }

            .hero-subheadline {
                font-size: 0.9rem;
            }

            .auth-title {
                font-size: 1.5rem;
            }

            .month-stats {
                gap: 0.5rem;
            }

            .stat-icon {
                width: 40px;
                height: 40px;
                font-size: 1.25rem;
            }

            h4 {
                font-size: 1.25rem;
            }

            h5 {
                font-size: 1.1rem;
            }

            .status-badge {
                padding: 0.4rem 1rem;
                font-size: 0.875rem;
            }

            .btn {
                font-size: 0.875rem;
                padding: 0.5rem 1rem;
            }

            .card-stat h5 {
                font-size: 1rem;
            }

            .footer-landing {
                text-align: center;
            }

            .footer-landing .col-md-6 {
                text-align: center !important;
                margin-bottom: 1rem;
            }
        }

        /* Tablet Responsive */
        @media (min-width: 769px) and (max-width: 1024px) {
            .sidebar {
                width: 220px;
            }

            .main-content {
                margin-left: 220px;
                width: calc(100% - 220px);
            }

            .hero-headline {
                font-size: 2.5rem;
            }

            .card-stat {
                padding: 1.25rem;
            }
        }

        /* Large Screen Optimization */
        @media (min-width: 1400px) {
            .container {
                max-width: 1320px;
            }

            .hero-headline {
                font-size: 4rem;
            }

            .hero-subheadline {
                font-size: 1.5rem;
            }
        }

        /* Touch Device Optimization */
        @media (hover: none) and (pointer: coarse) {
            .nav-item {
                padding: 1rem 1.5rem;
            }

            .cta-button, .btn {
                min-height: 44px;
                padding: 0.75rem 1.5rem;
            }

            .form-control, .form-select {
                font-size: 16px; /* Prevents zoom on iOS */
                min-height: 44px;
            }

            input[type="date"], input[type="number"] {
                font-size: 16px;
            }
        }

        /* Print Styles */
        @media print {
            .sidebar, .topbar button, .cta-button {
                display: none !important;
            }

            .main-content {
                margin-left: 0;
                width: 100%;
            }

            .card-stat {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body>

<!-- ========== LANDING PAGE ========== -->
<div id="landingPage" class="landing-page">
    <section class="hero-section">
        <div class="particles" id="particlesContainer"></div>
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 hero-content">
                    <h1 class="hero-headline">Kendalikan Keuanganmu dengan Aura Score</h1>
                    <p class="hero-subheadline">Analisis kesehatan keuangan berbasis AI yang membantu mahasiswa dan pekerja mengelola uang dengan lebih cerdas</p>
                    <button class="cta-button" onclick="goToLogin()">Mulai Analisis Gratis</button>
                </div>
                <div class="col-lg-6">
                    <div class="mockup-container">
                        <div class="mockup-glow"></div>
                        <div class="mockup-image">
                            <div class="score-visual mx-auto" style="width: 200px; height: 200px;">
                                <div class="score-circle">
                                    <div class="score-inner" style="width: 150px; height: 150px;">
                                        <div class="score-number" style="font-size: 3rem;">85</div>
                                        <small style="color: #9ca3af;">Aura Score</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="features-section">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="hero-headline" style="font-size: 2.5rem;">Fitur Unggulan</h2>
                <p class="hero-subheadline">Kelola keuangan dengan teknologi terdepan</p>
            </div>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">üìù</div>
                        <h3>Pencatatan Cerdas</h3>
                        <p style="color: #9ca3af;">Catat pengeluaran harian dengan mudah, kategorikan sebagai kebutuhan atau keinginan</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">ü§ñ</div>
                        <h3>Analisis AI</h3>
                        <p style="color: #9ca3af;">Sistem AI menganalisis 5 indikator kesehatan keuangan untuk memberikan insight mendalam</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">üìä</div>
                        <h3>Laporan Intuitif</h3>
                        <p style="color: #9ca3af;">Visualisasi data yang mudah dipahami dengan grafik interaktif dan rekomendasi personal</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="aura-score-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h2 class="hero-headline" style="font-size: 2.5rem;">Apa itu Aura Score?</h2>
                    <p class="hero-subheadline">Aura Score adalah skor kesehatan keuangan 0-100 yang dihitung berdasarkan 5 indikator kunci:</p>
                    <ul style="color: #9ca3af; font-size: 1.1rem; line-height: 2;">
                        <li>Perbandingan Pemasukan vs Pengeluaran</li>
                        <li>Proporsi Kebutuhan vs Keinginan</li>
                        <li>Konsistensi Pencatatan</li>
                        <li>Sisa Uang & Tabungan</li>
                        <li>Pola Pengeluaran Harian</li>
                    </ul>
                    <button class="cta-button mt-3" onclick="goToRegister()">Cek Aura Score Kamu</button>
                </div>
                <div class="col-lg-6">
                    <div class="score-visual">
                        <div class="score-circle">
                            <div class="score-inner">
                                <div class="score-number">70</div>
                                <small style="color: #9ca3af;">Potensi Skor</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer-landing">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 mb-3 mb-md-0">
                    <h4 class="sidebar-brand mb-2">Auraassist</h4>
                    <p style="color: #9ca3af; margin-bottom: 0;">Asisten keuangan pribadi untuk hidup lebih terencana</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p style="color: #9ca3af; margin-bottom: 0.5rem;">¬© 2024 Auraassist. All rights reserved.</p>
                    <small style="color: #6b7280;">Privacy Policy | Terms of Service</small>
                </div>
            </div>
        </div>
    </footer>
</div>

<!-- ========== LOGIN PAGE ========== -->
<div id="loginPage" class="auth-page hidden">
    <div class="container">
        <div class="auth-card mx-auto">
            <h2 class="auth-title">Masuk ke Auraassist</h2>
            <form onsubmit="return loginUser(event)">
                <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="loginEmail" required placeholder="nama@email.com">
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" required placeholder="Masukkan password">
                </div>
                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="rememberMe">
                    <label class="form-check-label">Ingat Saya</label>
                </div>
                <button type="submit" class="btn cta-button w-100 mb-3">Masuk</button>
                <p class="text-center" style="color: #9ca3af;">
                    Belum punya akun? <a href="#" onclick="goToRegister(); return false;" style="color: var(--electric-blue); text-decoration: none;">Daftar Sekarang</a>
                </p>
            </form>
        </div>
    </div>
</div>

<!-- ========== REGISTER PAGE ========== -->
<div id="registerPage" class="auth-page hidden">
    <div class="container">
        <div class="auth-card mx-auto">
            <h2 class="auth-title">Daftar Auraassist</h2>
            <form onsubmit="return registerUser(event)">
                <div class="mb-3">
                    <label class="form-label">Nama Lengkap</label>
                    <input type="text" class="form-control" id="registerName" required placeholder="Nama lengkap Anda">
                </div>
                <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="registerEmail" required placeholder="nama@email.com">
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="registerPassword" minlength="6" required placeholder="Minimal 6 karakter">
                    <small style="color: #9ca3af;">Minimal 6 karakter</small>
                </div>
                <button type="submit" class="btn cta-button w-100 mb-3">Daftar</button>
                <p class="text-center" style="color: #9ca3af;">
                    Sudah punya akun? <a href="#" onclick="goToLogin(); return false;" style="color: var(--electric-blue); text-decoration: none;">Masuk</a>
                </p>
            </form>
        </div>
    </div>
</div>

<!-- ========== DASHBOARD ========== -->
<div id="dashboardPage" class="hidden">
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    <div class="dashboard-wrapper">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="sidebar-brand">Auraassist</div>
                        <small style="color: rgba(255,255,255,0.6);" id="userNameDisplay">User</small>
                    </div>
                    <button class="btn btn-sm btn-link text-white d-md-none" onclick="toggleSidebar()">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
            </div>
            <div class="sidebar-nav">
                <div class="nav-item active" onclick="showSection('overview')">
                    <i class="bi bi-speedometer2 me-2"></i><span>Dashboard</span>
                </div>
                <div class="nav-item" onclick="showSection('pencatatan')">
                    <i class="bi bi-plus-circle me-2"></i><span>Pencatatan Harian</span>
                </div>
                <div class="nav-item" onclick="showSection('laporan')">
                    <i class="bi bi-graph-up me-2"></i><span>Laporan Bulanan</span>
                </div>
                <div class="nav-item" onclick="logoutUser()">
                    <i class="bi bi-box-arrow-right me-2"></i><span>Logout</span>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="topbar">
                <div>
                    <button class="btn btn-sm btn-primary d-md-none" onclick="toggleSidebar()">
                        <i class="bi bi-list"></i> Menu
                    </button>
                    <h4 class="d-inline ms-2 mb-0" id="pageTitle">Dashboard</h4>
                </div>
                <div class="d-none d-md-block">
                    <small id="currentDate"></small>
                </div>
            </div>

            <!-- Overview Section -->
            <div id="overviewSection">
                <div class="row g-3 g-md-4 mb-4">
                    <div class="col-12 col-lg-4">
                        <div class="card-stat">
                            <div class="aura-score-dashboard">
                                <div class="score-display" id="auraScoreDisplay">0</div>
                                <p class="mb-0">Aura Score</p>
                                <div class="status-badge status-sehat" id="statusBadge">Sehat</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-8">
                        <div class="row g-3">
                            <div class="col-12 col-sm-4">
                                <div class="card-stat">
                                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                        <i class="bi bi-cash-coin"></i>
                                    </div>
                                    <small class="text-muted">Pemasukan</small>
                                    <h4 id="totalIncome" class="mb-0">Rp 0</h4>
                                </div>
                            </div>
                            <div class="col-12 col-sm-4">
                                <div class="card-stat">
                                    <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                        <i class="bi bi-credit-card"></i>
                                    </div>
                                    <small class="text-muted">Pengeluaran</small>
                                    <h4 id="totalExpense" class="mb-0">Rp 0</h4>
                                </div>
                            </div>
                            <div class="col-12 col-sm-4">
                                <div class="card-stat">
                                    <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #8b5cf6);">
                                        <i class="bi bi-piggy-bank"></i>
                                    </div>
                                    <small class="text-muted">Sisa Dana</small>
                                    <h4 id="remainingMoney" class="mb-0">Rp 0</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-3 g-md-4">
                    <div class="col-12 col-lg-6">
                        <div class="card-stat">
                            <h5 class="mb-3">Proporsi Pengeluaran</h5>
                            <div class="chart-container">
                                <canvas id="donutChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-6">
                        <div class="card-stat">
                            <h5 class="mb-3">Tren Pengeluaran Harian</h5>
                            <div class="chart-container">
                                <canvas id="lineChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pencatatan Section -->
            <div id="pencatatanSection" class="hidden">
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="card-stat">
                            <h5 class="mb-3">Input Pemasukan</h5>
                            <form onsubmit="return addIncome(event)">
                                <div class="mb-3">
                                    <label class="form-label">Jumlah Pemasukan</label>
                                    <input type="number" class="form-control" id="incomeAmount" required placeholder="Contoh: 5000000">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Keterangan</label>
                                    <input type="text" class="form-control" id="incomeNote" required placeholder="Gaji, Uang Bulanan, dll">
                                </div>
                                <button type="submit" class="btn btn-gradient w-100">Tambah Pemasukan</button>
                            </form>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card-stat">
                            <h5 class="mb-3">Input Pengeluaran</h5>
                            <form onsubmit="return addExpense(event)">
                                <div class="mb-3">
                                    <label class="form-label">Jumlah Pengeluaran</label>
                                    <input type="number" class="form-control" id="expenseAmount" required placeholder="Contoh: 50000">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Kategori</label>
                                    <select class="form-control" id="expenseCategory" required>
                                        <option value="">Pilih Kategori</option>
                                        <option value="kebutuhan">Kebutuhan (Makan, Transport, Tagihan)</option>
                                        <option value="keinginan">Keinginan (Hiburan, Shopping, Hobi)</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Keterangan</label>
                                    <input type="text" class="form-control" id="expenseNote" required placeholder="Makan siang, Transport, dll">
                                </div>
                                <button type="submit" class="btn btn-gradient w-100">Tambah Pengeluaran</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="card-stat">
                    <h5 class="mb-3">Riwayat Transaksi Hari Ini</h5>
                    <div id="transactionList"></div>
                </div>
            </div>

            <!-- Laporan Section -->
            <div id="laporanSection" class="hidden">
                <!-- Selector Periode -->
                <div class="card-stat mb-4">
                    <div class="row align-items-center mb-3">
                        <div class="col-md-12">
                            <h5 class="mb-3">üìÖ Pilih Periode Laporan</h5>
                            <div class="btn-group w-100 mb-3" role="group">
                                <button type="button" class="btn btn-outline-primary active" id="btnMonthly" onclick="setPeriodType('monthly')">
                                    Bulanan
                                </button>
                                <button type="button" class="btn btn-outline-primary" id="btnDaily" onclick="setPeriodType('daily')">
                                    Harian
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Monthly Selector -->
                    <div id="monthlySelector">
                        <div class="row g-2">
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 0.875rem; margin-bottom: 0.25rem;">Bulan</label>
                                <select class="form-control" id="selectMonth" onchange="generateReport()">
                                    <option value="0">Januari</option>
                                    <option value="1">Februari</option>
                                    <option value="2">Maret</option>
                                    <option value="3">April</option>
                                    <option value="4">Mei</option>
                                    <option value="5">Juni</option>
                                    <option value="6">Juli</option>
                                    <option value="7">Agustus</option>
                                    <option value="8">September</option>
                                    <option value="9">Oktober</option>
                                    <option value="10">November</option>
                                    <option value="11">Desember</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 0.875rem; margin-bottom: 0.25rem;">Tahun</label>
                                <input type="number" class="form-control" id="selectYear" min="2020" max="2030" onchange="generateReport()" placeholder="2025">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Daily Selector -->
                    <div id="dailySelector" class="hidden">
                        <div class="row g-2">
                            <div class="col-md-4">
                                <label class="form-label" style="font-size: 0.875rem; margin-bottom: 0.25rem;">Tanggal</label>
                                <input type="date" class="form-control" id="selectDate" onchange="generateDailyReport()">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" style="font-size: 0.875rem; margin-bottom: 0.25rem;">Hari</label>
                                <input type="text" class="form-control" id="displayDay" readonly placeholder="Pilih tanggal">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" style="font-size: 0.875rem; margin-bottom: 0.25rem;">&nbsp;</label>
                                <button class="btn btn-gradient w-100" onclick="generateDailyReport()">Lihat Laporan</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Laporan Bulanan -->
                <div id="monthlyReport">
                    <div class="card-stat mb-4">
                        <h4 class="mb-3">Laporan Bulanan - <span id="reportMonth"></span></h4>
                        <div class="row g-3 mb-4">
                            <div class="col-md-3">
                                <div class="text-center">
                                    <div class="score-display" style="font-size: 3rem;" id="reportAuraScore">0</div>
                                    <small class="text-muted">Aura Score</small>
                                </div>
                            </div>
                            <div class="col-md-9">
                                <div class="status-badge status-sehat mb-2" id="reportStatus">Sehat</div>
                                <p id="reportSummary" class="text-muted"></p>
                            </div>
                        </div>
                    </div>

                    <h5 class="mb-3">Analisis 5 Indikator</h5>
                    <div id="indicatorsList"></div>

                    <div class="recommendation-box">
                        <h5>üí° Rekomendasi Personal</h5>
                        <div id="recommendationList"></div>
                    </div>
                </div>

                <!-- Laporan Harian -->
                <div id="dailyReport" class="hidden">
                    <div class="card-stat mb-4">
                        <h4 class="mb-3">Laporan Harian - <span id="dailyReportDate"></span></h4>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card-stat" style="background: linear-gradient(135deg, #10b981, #059669); color: white;">
                                    <h6>üí∞ Total Pemasukan</h6>
                                    <h3 id="dailyIncome">Rp 0</h3>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card-stat" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white;">
                                    <h6>üí∏ Total Pengeluaran</h6>
                                    <h3 id="dailyExpense">Rp 0</h3>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card-stat" style="background: linear-gradient(135deg, #3b82f6, #8b5cf6); color: white;">
                                    <h6>üè¶ Saldo Harian</h6>
                                    <h3 id="dailyBalance">Rp 0</h3>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card-stat mb-4">
                        <h5 class="mb-3">üìã Detail Transaksi Hari Ini</h5>
                        <div id="dailyTransactionList"></div>
                    </div>

                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="card-stat">
                                <h6 class="mb-3">Kebutuhan vs Keinginan</h6>
                                <div class="chart-container" style="height: 200px;">
                                    <canvas id="dailyDonutChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card-stat">
                                <h6 class="mb-3">Ringkasan Kategori</h6>
                                <div id="dailyCategorySummary"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Laporan Per Bulan (Card View) -->
                <div class="mt-5">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="mb-0">üìä Kesehatan Keuangan Per Bulan</h5>
                        <button class="btn btn-sm btn-outline-primary" onclick="toggleViewMode()">
                            <span id="viewModeText">Tampilan Grid</span>
                        </button>
                    </div>
                    <div id="monthlyCardsContainer"></div>
                </div>

                <!-- Track Record Bulanan (Table View) -->
                <div class="card-stat mt-4" id="trackRecordContainer">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="mb-0">üìà Track Record Kesehatan Keuangan</h5>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Periode</th>
                                    <th>Aura Score</th>
                                    <th>Status</th>
                                    <th>Pemasukan</th>
                                    <th>Pengeluaran</th>
                                    <th>Sisa</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="trackRecordTable">
                                <!-- Akan diisi dinamis -->
                            </tbody>
                        </table>
                    </div>
                    <div id="noTrackRecord" class="text-center text-muted py-3" style="display: none;">
                        Belum ada data track record
                    </div>
                </div>

                <!-- Grafik Tren Aura Score -->
                <div class="card-stat mt-4">
                    <h5 class="mb-3">üìà Tren Aura Score</h5>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <div class="alert alert-info mt-4">
                    <strong>üìä Tips:</strong> Gunakan selector bulan dan tahun di atas untuk melihat laporan periode tertentu. Lihat kesehatan keuangan per bulan secara terpisah di bawah untuk tracking yang lebih detail.
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// ========== GLOBAL STATE ==========
let currentUser = null;
let donutChart = null;
let lineChart = null;
let trendChart = null;
let dailyDonutChart = null;
let viewMode = 'table'; // 'table' or 'cards'
let periodType = 'monthly'; // 'monthly' or 'daily'

// ========== UTILITIES ==========
function hashPassword(password) {
    let hash = 0;
    for (let i = 0; i < password.length; i++) {
        const char = password.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
    }
    return hash.toString();
}

function formatMoney(amount) {
    return 'Rp ' + new Intl.NumberFormat('id-ID').format(amount);
}

function getToday() {
    return new Date().toISOString().split('T')[0];
}

function getCurrentMonth() {
    const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
    const now = new Date();
    return months[now.getMonth()] + ' ' + now.getFullYear();
}

// ========== NAVIGATION ==========
function showPage(pageName) {
    document.getElementById('landingPage').classList.add('hidden');
    document.getElementById('loginPage').classList.add('hidden');
    document.getElementById('registerPage').classList.add('hidden');
    document.getElementById('dashboardPage').classList.add('hidden');
    
    document.getElementById(pageName).classList.remove('hidden');
}

function goToLogin() {
    showPage('loginPage');
}

function goToRegister() {
    showPage('registerPage');
}

function goToDashboard() {
    showPage('dashboardPage');
    loadDashboard();
}

function showSection(sectionName) {
    document.getElementById('overviewSection').classList.add('hidden');
    document.getElementById('pencatatanSection').classList.add('hidden');
    document.getElementById('laporanSection').classList.add('hidden');
    
    document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
    
    if (sectionName === 'overview') {
        document.getElementById('overviewSection').classList.remove('hidden');
        document.getElementById('pageTitle').textContent = 'Dashboard';
        document.querySelectorAll('.nav-item')[0].classList.add('active');
        updateDashboard();
    } else if (sectionName === 'pencatatan') {
        document.getElementById('pencatatanSection').classList.remove('hidden');
        document.getElementById('pageTitle').textContent = 'Pencatatan Harian';
        document.querySelectorAll('.nav-item')[1].classList.add('active');
        loadTransactions();
    } else if (sectionName === 'laporan') {
        document.getElementById('laporanSection').classList.remove('hidden');
        document.getElementById('pageTitle').textContent = 'Laporan Bulanan';
        document.querySelectorAll('.nav-item')[2].classList.add('active');
        generateReport();
    }
}

function toggleSidebar() {
    document.getElementById('sidebar').classList.toggle('active');
}

// ========== AUTHENTICATION ==========
function registerUser(event) {
    event.preventDefault();
    
    const name = document.getElementById('registerName').value.trim();
    const email = document.getElementById('registerEmail').value.trim().toLowerCase();
    const password = document.getElementById('registerPassword').value;
    
    if (password.length < 6) {
        alert('‚ùå Password minimal 6 karakter!');
        return false;
    }
    
    let users = JSON.parse(localStorage.getItem('auraassist_users') || '[]');
    
    if (users.find(u => u.email === email)) {
        alert('‚ùå Email sudah terdaftar! Silakan gunakan email lain atau login.');
        return false;
    }
    
    const newUser = {
        id: 'user_' + Date.now(),
        name: name,
        email: email,
        password: hashPassword(password),
        createdAt: new Date().toISOString()
    };
    
    users.push(newUser);
    localStorage.setItem('auraassist_users', JSON.stringify(users));
    
    alert('‚úÖ Registrasi berhasil! Silakan login dengan akun Anda.');
    goToLogin();
    return false;
}

function loginUser(event) {
    event.preventDefault();
    
    const email = document.getElementById('loginEmail').value.trim().toLowerCase();
    const password = document.getElementById('loginPassword').value;
    const rememberMe = document.getElementById('rememberMe').checked;
    
    const users = JSON.parse(localStorage.getItem('auraassist_users') || '[]');
    const user = users.find(u => u.email === email && u.password === hashPassword(password));
    
    if (!user) {
        alert('‚ùå Email atau password salah! Silakan coba lagi.');
        return false;
    }
    
    const session = {
        userId: user.id,
        name: user.name,
        email: user.email,
        rememberMe: rememberMe,
        loginAt: new Date().toISOString()
    };
    
    localStorage.setItem('auraassist_session', JSON.stringify(session));
    currentUser = session;
    
    alert('‚úÖ Login berhasil! Selamat datang, ' + user.name + '!');
    goToDashboard();
    return false;
}

function logoutUser() {
    if (confirm('Yakin ingin logout?')) {
        localStorage.removeItem('auraassist_session');
        currentUser = null;
        showPage('landingPage');
        alert('‚úÖ Anda telah logout');
    }
}

function checkSession() {
    const session = JSON.parse(localStorage.getItem('auraassist_session'));
    if (session && session.rememberMe) {
        currentUser = session;
        goToDashboard();
    }
}

// ========== DASHBOARD ==========
function loadDashboard() {
    if (!currentUser) {
        goToLogin();
        return;
    }
    
    document.getElementById('userNameDisplay').textContent = currentUser.name;
    document.getElementById('currentDate').textContent = new Date().toLocaleDateString('id-ID', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    
    updateDashboard();
}

function getUserTransactions() {
    const allTransactions = JSON.parse(localStorage.getItem('auraassist_transactions') || '[]');
    return allTransactions.filter(t => t.userId === currentUser.userId);
}

function getCurrentMonthTransactions() {
    const transactions = getUserTransactions();
    const now = new Date();
    const currentMonth = now.getMonth();
    const currentYear = now.getFullYear();
    
    return transactions.filter(t => {
        const tDate = new Date(t.date);
        return tDate.getMonth() === currentMonth && tDate.getFullYear() === currentYear;
    });
}

function getMonthTransactions(month, year) {
    const transactions = getUserTransactions();
    
    return transactions.filter(t => {
        const tDate = new Date(t.date);
        return tDate.getMonth() === month && tDate.getFullYear() === year;
    });
}

function calculateStats() {
    const transactions = getCurrentMonthTransactions();
    
    let totalIncome = 0;
    let totalExpense = 0;
    let kebutuhanExpense = 0;
    let keinginanExpense = 0;
    
    transactions.forEach(t => {
        if (t.type === 'income') {
            totalIncome += t.amount;
        } else {
            totalExpense += t.amount;
            if (t.category === 'kebutuhan') {
                kebutuhanExpense += t.amount;
            } else {
                keinginanExpense += t.amount;
            }
        }
    });
    
    return {
        totalIncome,
        totalExpense,
        remainingMoney: totalIncome - totalExpense,
        kebutuhanExpense,
        keinginanExpense,
        transactions
    };
}

function calculateMonthStats(month, year) {
    const transactions = getMonthTransactions(month, year);
    
    let totalIncome = 0;
    let totalExpense = 0;
    let kebutuhanExpense = 0;
    let keinginanExpense = 0;
    
    transactions.forEach(t => {
        if (t.type === 'income') {
            totalIncome += t.amount;
        } else {
            totalExpense += t.amount;
            if (t.category === 'kebutuhan') {
                kebutuhanExpense += t.amount;
            } else {
                keinginanExpense += t.amount;
            }
        }
    });
    
    return {
        totalIncome,
        totalExpense,
        remainingMoney: totalIncome - totalExpense,
        kebutuhanExpense,
        keinginanExpense,
        transactions
    };
}

function calculate5Indicators() {
    const stats = calculateStats();
    const now = new Date();
    const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
    const currentDay = now.getDate();
    
    const uniqueDays = [...new Set(stats.transactions.map(t => t.date))].length;
    
    const indicators = [];
    
    // 1. Perbandingan Pemasukan vs Pengeluaran (20 poin)
    const balanceRatio = stats.totalIncome > 0 ? (stats.totalExpense / stats.totalIncome) : 1;
    const ind1Score = balanceRatio <= 0.7 ? 20 : (balanceRatio <= 0.9 ? 15 : (balanceRatio <= 1 ? 10 : 0));
    indicators.push({
        name: 'Perbandingan Pemasukan vs Pengeluaran',
        score: ind1Score,
        status: balanceRatio <= 0.9 ? 'good' : (balanceRatio <= 1 ? 'warning' : 'danger'),
        detail: `Pengeluaran ${(balanceRatio * 100).toFixed(1)}% dari pemasukan`
    });
    
    // 2. Proporsi Kebutuhan vs Keinginan (20 poin)
    const kebutuhanRatio = stats.totalExpense > 0 ? (stats.kebutuhanExpense / stats.totalExpense) : 0;
    const ind2Score = kebutuhanRatio >= 0.5 && kebutuhanRatio <= 0.7 ? 20 : (kebutuhanRatio >= 0.4 ? 15 : 10);
    indicators.push({
        name: 'Proporsi Kebutuhan vs Keinginan',
        score: ind2Score,
        status: kebutuhanRatio >= 0.5 ? 'good' : 'warning',
        detail: `Kebutuhan: ${(kebutuhanRatio * 100).toFixed(1)}%, Keinginan: ${((1-kebutuhanRatio) * 100).toFixed(1)}%`
    });
    
    // 3. Konsistensi Pencatatan (20 poin)
    const consistencyRatio = currentDay > 0 ? (uniqueDays / currentDay) : 0;
    const ind3Score = consistencyRatio >= 0.8 ? 20 : (consistencyRatio >= 0.6 ? 15 : 10);
    indicators.push({
        name: 'Konsistensi Pencatatan',
        score: ind3Score,
        status: consistencyRatio >= 0.6 ? 'good' : 'warning',
        detail: `${uniqueDays} dari ${currentDay} hari dicatat (${(consistencyRatio * 100).toFixed(1)}%)`
    });
    
    // 4. Sisa Uang/Tabungan (20 poin)
    const savingsRatio = stats.totalIncome > 0 ? (stats.remainingMoney / stats.totalIncome) : 0;
    const ind4Score = savingsRatio >= 0.2 ? 20 : (savingsRatio >= 0.1 ? 15 : (savingsRatio >= 0 ? 10 : 0));
    indicators.push({
        name: 'Sisa Uang & Tabungan',
        score: ind4Score,
        status: savingsRatio >= 0.1 ? 'good' : (savingsRatio >= 0 ? 'warning' : 'danger'),
        detail: `${(savingsRatio * 100).toFixed(1)}% dari pemasukan (${formatMoney(stats.remainingMoney)})`
    });
    
    // 5. Pola Pengeluaran Harian (20 poin)
    const dailyExpenses = {};
    stats.transactions.filter(t => t.type === 'expense').forEach(t => {
        if (!dailyExpenses[t.date]) dailyExpenses[t.date] = 0;
        dailyExpenses[t.date] += t.amount;
    });
    
    const expenseValues = Object.values(dailyExpenses);
    const avgDaily = expenseValues.length > 0 ? expenseValues.reduce((a, b) => a + b, 0) / expenseValues.length : 0;
    const spikes = expenseValues.filter(v => v > avgDaily * 1.5).length;
    const ind5Score = spikes === 0 ? 20 : (spikes <= 2 ? 15 : 10);
    indicators.push({
        name: 'Pola Pengeluaran Harian',
        score: ind5Score,
        status: spikes <= 1 ? 'good' : 'warning',
        detail: `${spikes} lonjakan pengeluaran terdeteksi`
    });
    
    const totalScore = indicators.reduce((sum, ind) => sum + ind.score, 0);
    
    return {
        indicators,
        totalScore,
        status: totalScore >= 80 ? 'Sehat' : (totalScore >= 60 ? 'Kurang Sehat' : 'Kritis')
    };
}

function calculateMonthIndicators(month, year) {
    const stats = calculateMonthStats(month, year);
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    
    const uniqueDays = [...new Set(stats.transactions.map(t => t.date))].length;
    
    const indicators = [];
    
    // 1. Perbandingan Pemasukan vs Pengeluaran (20 poin)
    const balanceRatio = stats.totalIncome > 0 ? (stats.totalExpense / stats.totalIncome) : 1;
    const ind1Score = balanceRatio <= 0.7 ? 20 : (balanceRatio <= 0.9 ? 15 : (balanceRatio <= 1 ? 10 : 0));
    indicators.push({
        name: 'Perbandingan Pemasukan vs Pengeluaran',
        score: ind1Score,
        status: balanceRatio <= 0.9 ? 'good' : (balanceRatio <= 1 ? 'warning' : 'danger'),
        detail: `Pengeluaran ${(balanceRatio * 100).toFixed(1)}% dari pemasukan`
    });
    
    // 2. Proporsi Kebutuhan vs Keinginan (20 poin)
    const kebutuhanRatio = stats.totalExpense > 0 ? (stats.kebutuhanExpense / stats.totalExpense) : 0;
    const ind2Score = kebutuhanRatio >= 0.5 && kebutuhanRatio <= 0.7 ? 20 : (kebutuhanRatio >= 0.4 ? 15 : 10);
    indicators.push({
        name: 'Proporsi Kebutuhan vs Keinginan',
        score: ind2Score,
        status: kebutuhanRatio >= 0.5 ? 'good' : 'warning',
        detail: `Kebutuhan: ${(kebutuhanRatio * 100).toFixed(1)}%, Keinginan: ${((1-kebutuhanRatio) * 100).toFixed(1)}%`
    });
    
    // 3. Konsistensi Pencatatan (20 poin)
    const consistencyRatio = daysInMonth > 0 ? (uniqueDays / daysInMonth) : 0;
    const ind3Score = consistencyRatio >= 0.8 ? 20 : (consistencyRatio >= 0.6 ? 15 : 10);
    indicators.push({
        name: 'Konsistensi Pencatatan',
        score: ind3Score,
        status: consistencyRatio >= 0.6 ? 'good' : 'warning',
        detail: `${uniqueDays} dari ${daysInMonth} hari dicatat (${(consistencyRatio * 100).toFixed(1)}%)`
    });
    
    // 4. Sisa Uang/Tabungan (20 poin)
    const savingsRatio = stats.totalIncome > 0 ? (stats.remainingMoney / stats.totalIncome) : 0;
    const ind4Score = savingsRatio >= 0.2 ? 20 : (savingsRatio >= 0.1 ? 15 : (savingsRatio >= 0 ? 10 : 0));
    indicators.push({
        name: 'Sisa Uang & Tabungan',
        score: ind4Score,
        status: savingsRatio >= 0.1 ? 'good' : (savingsRatio >= 0 ? 'warning' : 'danger'),
        detail: `${(savingsRatio * 100).toFixed(1)}% dari pemasukan (${formatMoney(stats.remainingMoney)})`
    });
    
    // 5. Pola Pengeluaran Harian (20 poin)
    const dailyExpenses = {};
    stats.transactions.filter(t => t.type === 'expense').forEach(t => {
        if (!dailyExpenses[t.date]) dailyExpenses[t.date] = 0;
        dailyExpenses[t.date] += t.amount;
    });
    
    const expenseValues = Object.values(dailyExpenses);
    const avgDaily = expenseValues.length > 0 ? expenseValues.reduce((a, b) => a + b, 0) / expenseValues.length : 0;
    const spikes = expenseValues.filter(v => v > avgDaily * 1.5).length;
    const ind5Score = spikes === 0 ? 20 : (spikes <= 2 ? 15 : 10);
    indicators.push({
        name: 'Pola Pengeluaran Harian',
        score: ind5Score,
        status: spikes <= 1 ? 'good' : 'warning',
        detail: `${spikes} lonjakan pengeluaran terdeteksi`
    });
    
    const totalScore = indicators.reduce((sum, ind) => sum + ind.score, 0);
    
    return {
        indicators,
        totalScore,
        status: totalScore >= 80 ? 'Sehat' : (totalScore >= 60 ? 'Kurang Sehat' : 'Kritis'),
        stats
    };
}

function updateDashboard() {
    const stats = calculateStats();
    const analysis = calculate5Indicators();
    
    document.getElementById('totalIncome').textContent = formatMoney(stats.totalIncome);
    document.getElementById('totalExpense').textContent = formatMoney(stats.totalExpense);
    document.getElementById('remainingMoney').textContent = formatMoney(stats.remainingMoney);
    document.getElementById('auraScoreDisplay').textContent = analysis.totalScore;
    
    const statusBadge = document.getElementById('statusBadge');
    statusBadge.textContent = analysis.status;
    statusBadge.className = 'status-badge ' + 
        (analysis.status === 'Sehat' ? 'status-sehat' : 
         analysis.status === 'Kurang Sehat' ? 'status-kurang' : 'status-kritis');
    
    updateCharts(stats);
}

function updateCharts(stats) {
    // Donut Chart
    const donutCtx = document.getElementById('donutChart');
    if (donutChart) donutChart.destroy();
    
    donutChart = new Chart(donutCtx, {
        type: 'doughnut',
        data: {
            labels: ['Kebutuhan', 'Keinginan'],
            datasets: [{
                data: [stats.kebutuhanExpense || 1, stats.keinginanExpense || 1],
                backgroundColor: ['#10b981', '#f59e0b']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
    
    // Line Chart
    const dailyExpenses = {};
    stats.transactions.filter(t => t.type === 'expense').forEach(t => {
        if (!dailyExpenses[t.date]) dailyExpenses[t.date] = 0;
        dailyExpenses[t.date] += t.amount;
    });
    
    const sortedDates = Object.keys(dailyExpenses).sort();
    const expenseValues = sortedDates.map(date => dailyExpenses[date]);
    
    const lineCtx = document.getElementById('lineChart');
    if (lineChart) lineChart.destroy();
    
    lineChart = new Chart(lineCtx, {
        type: 'line',
        data: {
            labels: sortedDates.map(d => new Date(d).getDate()),
            datasets: [{
                label: 'Pengeluaran Harian',
                data: expenseValues.length > 0 ? expenseValues : [0],
                borderColor: '#3b82f6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4,
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

// ========== TRANSACTIONS ==========
function addIncome(event) {
    event.preventDefault();
    
    const amount = parseInt(document.getElementById('incomeAmount').value);
    const note = document.getElementById('incomeNote').value.trim();
    
    if (!amount || amount <= 0) {
        alert('‚ùå Masukkan jumlah pemasukan yang valid!');
        return false;
    }
    
    const transaction = {
        id: 'trans_' + Date.now(),
        userId: currentUser.userId,
        type: 'income',
        amount: amount,
        note: note,
        date: getToday(),
        createdAt: new Date().toISOString()
    };
    
    const allTransactions = JSON.parse(localStorage.getItem('auraassist_transactions') || '[]');
    allTransactions.push(transaction);
    localStorage.setItem('auraassist_transactions', JSON.stringify(allTransactions));
    
    alert('‚úÖ Pemasukan berhasil ditambahkan!');
    event.target.reset();
    loadTransactions();
    updateDashboard();
    return false;
}

function addExpense(event) {
    event.preventDefault();
    
    const amount = parseInt(document.getElementById('expenseAmount').value);
    const category = document.getElementById('expenseCategory').value;
    const note = document.getElementById('expenseNote').value.trim();
    
    if (!amount || amount <= 0) {
        alert('‚ùå Masukkan jumlah pengeluaran yang valid!');
        return false;
    }
    
    if (!category) {
        alert('‚ùå Pilih kategori pengeluaran!');
        return false;
    }
    
    const transaction = {
        id: 'trans_' + Date.now(),
        userId: currentUser.userId,
        type: 'expense',
        amount: amount,
        category: category,
        note: note,
        date: getToday(),
        createdAt: new Date().toISOString()
    };
    
    const allTransactions = JSON.parse(localStorage.getItem('auraassist_transactions') || '[]');
    allTransactions.push(transaction);
    localStorage.setItem('auraassist_transactions', JSON.stringify(allTransactions));
    
    alert('‚úÖ Pengeluaran berhasil ditambahkan!');
    event.target.reset();
    loadTransactions();
    updateDashboard();
    return false;
}

function loadTransactions() {
    const transactions = getUserTransactions();
    const today = getToday();
    const todayTransactions = transactions.filter(t => t.date === today);
    
    const container = document.getElementById('transactionList');
    
    if (todayTransactions.length === 0) {
        container.innerHTML = '<p class="text-muted text-center">Belum ada transaksi hari ini</p>';
        return;
    }
    
    container.innerHTML = todayTransactions.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).map(t => `
        <div class="transaction-item">
            <div>
                <strong>${t.type === 'income' ? 'üí∞' : 'üí∏'} ${t.note}</strong>
                <br>
                <small class="text-muted">${t.category ? 'Kategori: ' + t.category : 'Pemasukan'}</small>
            </div>
            <div class="text-end">
                <strong style="color: ${t.type === 'income' ? '#10b981' : '#ef4444'}">
                    ${t.type === 'income' ? '+' : '-'} ${formatMoney(t.amount)}
                </strong>
            </div>
        </div>
    `).join('');
}

// ========== REPORT ==========
function setPeriodType(type) {
    periodType = type;
    
    // Toggle button active state
    document.getElementById('btnMonthly').classList.remove('active');
    document.getElementById('btnDaily').classList.remove('active');
    
    if (type === 'monthly') {
        document.getElementById('btnMonthly').classList.add('active');
        document.getElementById('monthlySelector').classList.remove('hidden');
        document.getElementById('dailySelector').classList.add('hidden');
        document.getElementById('monthlyReport').classList.remove('hidden');
        document.getElementById('dailyReport').classList.add('hidden');
        generateReport();
    } else {
        document.getElementById('btnDaily').classList.add('active');
        document.getElementById('monthlySelector').classList.add('hidden');
        document.getElementById('dailySelector').classList.remove('hidden');
        document.getElementById('monthlyReport').classList.add('hidden');
        document.getElementById('dailyReport').classList.remove('hidden');
        
        // Set today's date
        const today = getToday();
        document.getElementById('selectDate').value = today;
        updateDayDisplay(today);
        generateDailyReport();
    }
}

function updateDayDisplay(dateString) {
    const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
    const date = new Date(dateString);
    const dayName = days[date.getDay()];
    document.getElementById('displayDay').value = dayName;
}

function initReportSelectors() {
    const now = new Date();
    const currentMonth = now.getMonth();
    const currentYear = now.getFullYear();
    
    // Set current month and year
    document.getElementById('selectMonth').value = currentMonth;
    document.getElementById('selectYear').value = currentYear;
    
    // Set current date
    document.getElementById('selectDate').value = getToday();
    updateDayDisplay(getToday());
    
    // Add event listener for date change
    document.getElementById('selectDate').addEventListener('change', function() {
        updateDayDisplay(this.value);
    });
}

function generateReport() {
    const selectedMonth = parseInt(document.getElementById('selectMonth').value);
    const selectedYearInput = document.getElementById('selectYear').value;
    
    // Validasi tahun
    if (!selectedYearInput || selectedYearInput === '') {
        const now = new Date();
        document.getElementById('selectYear').value = now.getFullYear();
        return;
    }
    
    const selectedYear = parseInt(selectedYearInput);
    
    const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
    document.getElementById('reportMonth').textContent = months[selectedMonth] + ' ' + selectedYear;
    
    const analysis = calculateMonthIndicators(selectedMonth, selectedYear);
    
    document.getElementById('reportAuraScore').textContent = analysis.totalScore;
    
    const reportStatus = document.getElementById('reportStatus');
    reportStatus.textContent = analysis.status;
    reportStatus.className = 'status-badge ' + 
        (analysis.status === 'Sehat' ? 'status-sehat' : 
         analysis.status === 'Kurang Sehat' ? 'status-kurang' : 'status-kritis');
    
    document.getElementById('reportSummary').textContent = 
        `Berdasarkan analisis 5 indikator keuangan, kondisi finansial Anda saat ini: ${analysis.status}. Total transaksi bulan ini: ${analysis.stats.transactions.length} transaksi.`;
    
    // Indicators List
    const indicatorsList = document.getElementById('indicatorsList');
    indicatorsList.innerHTML = analysis.indicators.map(ind => `
        <div class="indicator-card ${ind.status === 'good' ? '' : ind.status === 'warning' ? 'warning' : 'danger'}">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <strong>${ind.name}</strong>
                <span class="badge bg-primary">${ind.score}/20</span>
            </div>
            <p class="text-muted mb-0">${ind.detail}</p>
        </div>
    `).join('');
    
    // Recommendations
    const recommendations = [];
    
    if (analysis.indicators[0].status !== 'good') {
        recommendations.push('Kurangi pengeluaran atau tingkatkan pemasukan agar keuangan lebih seimbang');
    }
    if (analysis.indicators[1].status !== 'good') {
        recommendations.push('Prioritaskan pengeluaran untuk kebutuhan (50-70%), kurangi pengeluaran keinginan');
    }
    if (analysis.indicators[2].status !== 'good') {
        recommendations.push('Catat transaksi setiap hari agar analisis lebih akurat dan terukur');
    }
    if (analysis.indicators[3].status !== 'good') {
        recommendations.push('Sisihkan minimal 10-20% dari pemasukan untuk tabungan atau dana darurat');
    }
    if (analysis.indicators[4].status !== 'good') {
        recommendations.push('Hindari pembelian impulsif, buat perencanaan pengeluaran mingguan atau bulanan');
    }
    
    if (recommendations.length === 0) {
        recommendations.push('Selamat! Anda sudah mengelola keuangan dengan sangat baik. Pertahankan kebiasaan finansial yang sehat ini.');
    }
    
    document.getElementById('recommendationList').innerHTML = recommendations.map(r => 
        `<p class="mb-2">‚úì ${r}</p>`
    ).join('');
    
    // Generate Track Record
    generateTrackRecord();
    
    // Generate Monthly Cards
    generateMonthlyCards();
    
    // Generate Trend Chart
    generateTrendChart();
}

function generateDailyReport() {
    const selectedDate = document.getElementById('selectDate').value;
    
    if (!selectedDate) {
        alert('‚ùå Pilih tanggal terlebih dahulu!');
        return;
    }
    
    updateDayDisplay(selectedDate);
    
    const transactions = getUserTransactions();
    const dailyTransactions = transactions.filter(t => t.date === selectedDate);
    
    // Calculate daily stats
    let dailyIncome = 0;
    let dailyExpense = 0;
    let kebutuhanExpense = 0;
    let keinginanExpense = 0;
    
    dailyTransactions.forEach(t => {
        if (t.type === 'income') {
            dailyIncome += t.amount;
        } else {
            dailyExpense += t.amount;
            if (t.category === 'kebutuhan') {
                kebutuhanExpense += t.amount;
            } else {
                keinginanExpense += t.amount;
            }
        }
    });
    
    const dailyBalance = dailyIncome - dailyExpense;
    
    // Display date
    const date = new Date(selectedDate);
    const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
    const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
    document.getElementById('dailyReportDate').textContent = 
        `${days[date.getDay()]}, ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
    
    // Display summary
    document.getElementById('dailyIncome').textContent = formatMoney(dailyIncome);
    document.getElementById('dailyExpense').textContent = formatMoney(dailyExpense);
    document.getElementById('dailyBalance').textContent = formatMoney(dailyBalance);
    
    // Display transactions
    const transactionList = document.getElementById('dailyTransactionList');
    
    if (dailyTransactions.length === 0) {
        transactionList.innerHTML = '<p class="text-muted text-center">Tidak ada transaksi pada tanggal ini</p>';
    } else {
        transactionList.innerHTML = dailyTransactions.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).map(t => `
            <div class="transaction-item">
                <div>
                    <strong>${t.type === 'income' ? 'üí∞' : 'üí∏'} ${t.note}</strong>
                    <br>
                    <small class="text-muted">${t.category ? 'Kategori: ' + t.category : 'Pemasukan'} ‚Ä¢ ${new Date(t.createdAt).toLocaleTimeString('id-ID', {hour: '2-digit', minute: '2-digit'})}</small>
                </div>
                <div class="text-end">
                    <strong style="color: ${t.type === 'income' ? '#10b981' : '#ef4444'}">
                        ${t.type === 'income' ? '+' : '-'} ${formatMoney(t.amount)}
                    </strong>
                </div>
            </div>
        `).join('');
    }
    
    // Display donut chart
    const donutCtx = document.getElementById('dailyDonutChart');
    if (dailyDonutChart) dailyDonutChart.destroy();
    
    dailyDonutChart = new Chart(donutCtx, {
        type: 'doughnut',
        data: {
            labels: ['Kebutuhan', 'Keinginan'],
            datasets: [{
                data: [kebutuhanExpense || 1, keinginanExpense || 1],
                backgroundColor: ['#10b981', '#f59e0b']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
    
    // Display category summary
    const categorySummary = document.getElementById('dailyCategorySummary');
    const totalExpense = kebutuhanExpense + keinginanExpense;
    const kebutuhanPercent = totalExpense > 0 ? (kebutuhanExpense / totalExpense * 100).toFixed(1) : 0;
    const keinginanPercent = totalExpense > 0 ? (keinginanExpense / totalExpense * 100).toFixed(1) : 0;
    
    categorySummary.innerHTML = `
        <div class="mb-3" style="background: #f3f4f6; padding: 1rem; border-radius: 8px;">
            <div class="d-flex justify-content-between mb-2">
                <span>üçΩÔ∏è Kebutuhan</span>
                <strong style="color: #10b981;">${kebutuhanPercent}%</strong>
            </div>
            <div class="progress mb-1" style="height: 10px;">
                <div class="progress-bar bg-success" style="width: ${kebutuhanPercent}%"></div>
            </div>
            <small class="text-muted">${formatMoney(kebutuhanExpense)}</small>
        </div>
        
        <div style="background: #f3f4f6; padding: 1rem; border-radius: 8px;">
            <div class="d-flex justify-content-between mb-2">
                <span>üéÆ Keinginan</span>
                <strong style="color: #f59e0b;">${keinginanPercent}%</strong>
            </div>
            <div class="progress mb-1" style="height: 10px;">
                <div class="progress-bar bg-warning" style="width: ${keinginanPercent}%"></div>
            </div>
            <small class="text-muted">${formatMoney(keinginanExpense)}</small>
        </div>
        
        <div class="mt-3 pt-3" style="border-top: 1px solid #e5e7eb;">
            <div class="d-flex justify-content-between">
                <strong>Total Pengeluaran</strong>
                <strong style="color: #ef4444;">${formatMoney(totalExpense)}</strong>
            </div>
        </div>
    `;
}

function toggleViewMode() {
    viewMode = viewMode === 'table' ? 'cards' : 'table';
    document.getElementById('viewModeText').textContent = viewMode === 'table' ? 'Tampilan Grid' : 'Tampilan Tabel';
    
    if (viewMode === 'cards') {
        document.getElementById('trackRecordContainer').style.display = 'none';
        document.getElementById('monthlyCardsContainer').style.display = 'block';
    } else {
        document.getElementById('trackRecordContainer').style.display = 'block';
        document.getElementById('monthlyCardsContainer').style.display = 'none';
    }
}

function generateMonthlyCards() {
    const transactions = getUserTransactions();
    
    // Get all unique month-year combinations
    const monthYearSet = new Set();
    transactions.forEach(t => {
        const date = new Date(t.date);
        const key = `${date.getFullYear()}-${date.getMonth()}`;
        monthYearSet.add(key);
    });
    
    const monthYears = Array.from(monthYearSet).map(key => {
        const [year, month] = key.split('-');
        return { year: parseInt(year), month: parseInt(month) };
    });
    
    // Sort by date descending
    monthYears.sort((a, b) => {
        if (a.year !== b.year) return b.year - a.year;
        return b.month - a.month;
    });
    
    const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
    
    const container = document.getElementById('monthlyCardsContainer');
    
    if (monthYears.length === 0) {
        container.innerHTML = '<p class="text-muted text-center">Belum ada data keuangan</p>';
        return;
    }
    
    container.innerHTML = monthYears.map(my => {
        const analysis = calculateMonthIndicators(my.month, my.year);
        const statusClass = analysis.status === 'Sehat' ? 'sehat' : (analysis.status === 'Kurang Sehat' ? 'kurang' : 'kritis');
        const statusBadgeClass = analysis.status === 'Sehat' ? 'success' : (analysis.status === 'Kurang Sehat' ? 'warning' : 'danger');
        
        return `
            <div class="month-card ${statusClass}">
                <div class="month-card-header">
                    <div>
                        <div class="month-title">${months[my.month]} ${my.year}</div>
                        <span class="badge bg-${statusBadgeClass}">${analysis.status}</span>
                    </div>
                    <div class="text-end">
                        <div class="month-score">${analysis.totalScore}</div>
                        <small class="text-muted">Aura Score</small>
                    </div>
                </div>
                
                <div class="month-stats">
                    <div class="month-stat-item">
                        <div class="month-stat-label">Pemasukan</div>
                        <div class="month-stat-value" style="color: #10b981;">${formatMoney(analysis.stats.totalIncome)}</div>
                    </div>
                    <div class="month-stat-item">
                        <div class="month-stat-label">Pengeluaran</div>
                        <div class="month-stat-value" style="color: #ef4444;">${formatMoney(analysis.stats.totalExpense)}</div>
                    </div>
                    <div class="month-stat-item">
                        <div class="month-stat-label">Sisa Dana</div>
                        <div class="month-stat-value" style="color: ${analysis.stats.remainingMoney >= 0 ? '#10b981' : '#ef4444'}">
                            ${formatMoney(analysis.stats.remainingMoney)}
                        </div>
                    </div>
                </div>
                
                <div class="row g-2">
                    <div class="col-6">
                        <div style="background: #f3f4f6; padding: 0.75rem; border-radius: 8px; text-align: center;">
                            <small class="text-muted d-block">Kebutuhan</small>
                            <strong style="color: #10b981;">${formatMoney(analysis.stats.kebutuhanExpense)}</strong>
                        </div>
                    </div>
                    <div class="col-6">
                        <div style="background: #f3f4f6; padding: 0.75rem; border-radius: 8px; text-align: center;">
                            <small class="text-muted d-block">Keinginan</small>
                            <strong style="color: #f59e0b;">${formatMoney(analysis.stats.keinginanExpense)}</strong>
                        </div>
                    </div>
                </div>
                
                <div class="mt-3">
                    <button class="btn btn-sm btn-gradient w-100" onclick="viewMonthReport(${my.month}, ${my.year})">
                        üìä Lihat Analisis Lengkap
                    </button>
                </div>
            </div>
        `;
    }).join('');
    
    // Set initial view mode
    if (viewMode === 'table') {
        container.style.display = 'none';
    }
}

function generateTrackRecord() {
    const transactions = getUserTransactions();
    
    // Get all unique month-year combinations
    const monthYearSet = new Set();
    transactions.forEach(t => {
        const date = new Date(t.date);
        const key = `${date.getFullYear()}-${date.getMonth()}`;
        monthYearSet.add(key);
    });
    
    const monthYears = Array.from(monthYearSet).map(key => {
        const [year, month] = key.split('-');
        return { year: parseInt(year), month: parseInt(month) };
    });
    
    // Sort by date descending
    monthYears.sort((a, b) => {
        if (a.year !== b.year) return b.year - a.year;
        return b.month - a.month;
    });
    
    if (monthYears.length === 0) {
        document.getElementById('noTrackRecord').style.display = 'block';
        document.getElementById('trackRecordTable').innerHTML = '';
        return;
    }
    
    document.getElementById('noTrackRecord').style.display = 'none';
    
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
    
    const tableBody = document.getElementById('trackRecordTable');
    tableBody.innerHTML = monthYears.map(my => {
        const analysis = calculateMonthIndicators(my.month, my.year);
        const statusClass = analysis.status === 'Sehat' ? 'success' : (analysis.status === 'Kurang Sehat' ? 'warning' : 'danger');
        
        return `
            <tr>
                <td><strong>${months[my.month]} ${my.year}</strong></td>
                <td><span class="badge bg-primary">${analysis.totalScore}</span></td>
                <td><span class="badge bg-${statusClass}">${analysis.status}</span></td>
                <td>${formatMoney(analysis.stats.totalIncome)}</td>
                <td>${formatMoney(analysis.stats.totalExpense)}</td>
                <td style="color: ${analysis.stats.remainingMoney >= 0 ? '#10b981' : '#ef4444'}">${formatMoney(analysis.stats.remainingMoney)}</td>
                <td>
                    <button class="btn btn-sm btn-outline-primary" onclick="viewMonthReport(${my.month}, ${my.year})">
                        Lihat Detail
                    </button>
                </td>
            </tr>
        `;
    }).join('');
}

function viewMonthReport(month, year) {
    document.getElementById('selectMonth').value = month;
    document.getElementById('selectYear').value = year;
    generateReport();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function generateTrendChart() {
    const transactions = getUserTransactions();
    
    // Get all unique month-year combinations
    const monthYearSet = new Set();
    transactions.forEach(t => {
        const date = new Date(t.date);
        const key = `${date.getFullYear()}-${date.getMonth()}`;
        monthYearSet.add(key);
    });
    
    const monthYears = Array.from(monthYearSet).map(key => {
        const [year, month] = key.split('-');
        return { year: parseInt(year), month: parseInt(month) };
    });
    
    // Sort by date ascending
    monthYears.sort((a, b) => {
        if (a.year !== b.year) return a.year - b.year;
        return a.month - b.month;
    });
    
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
    
    const labels = monthYears.map(my => `${months[my.month]} ${my.year}`);
    const scores = monthYears.map(my => {
        const analysis = calculateMonthIndicators(my.month, my.year);
        return analysis.totalScore;
    });
    
    const trendCtx = document.getElementById('trendChart');
    if (trendChart) trendChart.destroy();
    
    trendChart = new Chart(trendCtx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Aura Score',
                data: scores,
                borderColor: '#3b82f6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4,
                fill: true,
                pointRadius: 5,
                pointHoverRadius: 7
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        stepSize: 20
                    }
                }
            }
        }
    });
}

// ========== PARTICLES ==========
function createParticles() {
    const container = document.getElementById('particlesContainer');
    if (!container) return;
    
    for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.width = Math.random() * 100 + 50 + 'px';
        particle.style.height = particle.style.width;
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 20 + 's';
        particle.style.animationDuration = (Math.random() * 10 + 15) + 's';
        container.appendChild(particle);
    }
}

// ========== INIT ==========
window.onload = function() {
    createParticles();
    checkSession();
};
</script>

</body>
</html>
